<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>상세조회(스터디가입)</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/public/css/detailedPost.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <script>
        function detailed() {
            console.log('스터디 그룹에 가입하시겠습니까?');

            if (data == "") { // 가입 신청을 누르면
                True();
            } else { // 취소를 누르면
                back();
            }
        }
        // YES 버튼을 누를 경우
        function True() {
            var form = document.getElementById("deatailPost");
                axios({
                    method:'post',
                    url: "http://localhost:8000/feed/detailedPost/join",
                    data: {
                        study_id : form.study_id.value
                    }
                })
                .then((req) => { return req.data;})
                .then((data) => {
                    alert("가입되었습니다");
                })
        } 
        // 목록 버튼을 누르면
        function detailedPost_index() {
                document.location.href="http://localhost:8000/swith";
            }

        // 인원 마감이 되면 스터가입 버튼 비활성화
        function detailed() {
            const target = document.getElementById('study_result');
                target.disabled = false;
        }   
    </script>
</head>
<body>
    <nav>

    </nav>
        <tbody>
            <div class="wrap">
                <form id="deatailPost" name="deatailPost">
                    <!-- <div class="CategoryImage" style="color:white;"> -->
                    <div class="box">
                        <div class="img_box">
                            <!-- 카테고리별 이미지 -->
                            <div class="CategoryImage">
                                <!-- 카테고리별 임시 이미지 저장 밑에 path에 저장해서 사용하세요-->
                                <!-- <img src="/public/category" height="300" style="border-radius:15px;"> -->
                            </div>


                            <!-- 스터디 이미지(등록이미지)  -->
                            <!-- <div class="studyImage" style="color:white;">  -->              
                            <div class="studyImage"> 
                                <!-- 스터디 이미지는 아직 없어서 안불러와 질 것 같아서 주석할게요-->
                                <!-- <% if(locals.result[0]) { %>
                                    <img src="/public/user/<%= result[0].study_image%>" width="1000" height="300" style="border-radius:15px;">
                                <% } else { %>
                                    <img src="/public/user/<%= result.study_image%>" width="1000" height="300" style="border-radius:15px;">
                                <% } %>  --> 
                                <!-- 스터디 이름 -->
                                <div class="studyName">
                                    <p class="studyName_2">
                                    <!-- <% if(locals.result[0]) { %> -->
                                        <span class="studyName_txt"><%= result[0].study_name %></span>
                                    <% } else { %>
                                        <span class="studyName_txt"><%= result.study_name %></span>
                                    <% } %>   
                                    </p>
                                    <!-- <ul>
                                        <li>장소</li>
                                        <li>모임시간</li>
                                        <li>첫 모임일</li>
                                    </ul> -->
                                </div>
                            </div>
                        <!-- </div>     -->
                
                    <!-- <div class="section_box"> -->

                        <div class="section_box">
                            <div class="name">스터디 소개글</div>
                            <div class="value"><%=result[0].study_content %>
                            </div>
                        </div>
                        
                        <div class="section_box">
                            <div class="name">해시태그</div>
                            <div class="value"><%=result[0].hashtag %>
                            </div>
                        </div>
                        
                        
                        <div class="section_box">
                            <div class="name">스터디 현재멤버</div>
                                <div class="name name_image"> <% if(locals.result[0]) { %>
                                    <% for(var i=0; i < result.length; i++) { %>
                                        <img src="/public/user/<%= result[i].user_image%>" width="1000" height="300" style="border-radius:15px;">
                                            <% } %>
                                    <% } %>
                                </div>
                                <br>
                                <div class="result_txt">
                                <!-- 닉네임  -->
                                <% if(locals.result[0]) { %>
                                    <% for(var i=0; i < result.length; i++) { %>
                                        <span><%= result[i].user_name %></span>
                                    <% } %>
                                <% } %>
                            </div>
                        </div>

                        
                        
                        
                        <div class="section_box">
                            <div class="name">스터디 형태</div>
                            <div class="value"><% if(locals.result[0]) { %>
                                <%= result[0].study_form %>
                                    <% } else { %>
                                        <%= result.study_form %>
                                    <% } %>
                            </div>
                        </div>
                        <div class="section_box">
                            <div class="name">스터디위치</div>
                            <div class="value"><% if(locals.result[0]) { %>
                                <%= result[0].study_address %>
                                    <% } else { %>
                                    <%= result.study_address %>
                                <% } %>
                            </div>
                        </div>
                        
                        <div class="section_box">
                            <div class="name">모집인원</div>

                            <div class="value"><% if(locals.result[0]) { %>
                                <%= result[0].study_recruit %>
                                    <% } else { %>
                                    <%= result.study_recruit %>
                                <% } %>
                            </div>
                        </div>

                        <div class="section_box">
                            <div class="name">스터디기간</div>
                            <div class="value">
                                <!-- 시작일 -->
                                <% if(locals.result[0]) { %>
                                <%= result[0].start_period %>
                                    <% } else { %>
                                <%= result.start_period %>
                                    <% } %>
                                <!-- 마감일 -->
                                <% if(locals.result[0]) { %>
                                <%= result[0].end_period %>
                                    <% } else { %>
                                <%= result.end_period %>
                                    <% } %>
                            </div>
                        </div>
                        
                        <!-- <button type="button" onclick="detailed()" class="detail" style="color:white">탈퇴하기</button> -->
    
                        <!-- Button trigger modal -->
                        <button type="button" onclick="detailed()" class="btn btn-primary detail" data-bs-toggle="modal" data-bs-target="#exampleModal" style="color:white">스터디가입</button>
                        
                        <!-- 탈퇴 Modal -->
                        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">스터디 그룹에 가입하시겠습니까?</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="취소"></button>
                                </div>
                                <!-- <div class="modal-body">
                                    
                                </div> -->
                                <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">NO</button>
                                <button type="button" class="btn btn-primary">YES</button>
                                </div>
                            </div>
                            </div>
                        </div>

                        <div>
                            <div id="ture" class="ture"></div>
                            <div id="back" class="back"></div>
                        </div>
                        
    
                        <div class="regi_btn_wrap">
                            <div class="regi_txt">
                                <span>등록가능</span>
                                <span>마감</span>
                            </div>
                            
                            <button class="regi_btn" type="button" onclick="detailedPost_index()" class="list" style="color:white">목록</button>
                        </div>
                    </div>
                    
                </div>   
                </form>
            </div>
        </tbody>
</body>
</html>